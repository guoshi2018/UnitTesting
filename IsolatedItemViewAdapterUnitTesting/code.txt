//namespace IsolatedItemViewAdapterUnitTesting
//{

//    //public class ItemViewCursorAdapter<TData> : ArrayAdapter<TData>
//    //{
//    //    protected readonly List<ViewInfoWrapper<TData>> _wrappers;
//    //    protected readonly Activity _activity;
//    //    protected readonly int _itemViewLayoutId;
//    //    protected readonly Action<View, int, ViewGroup?>? _renderItemView;

//    //    public ItemViewCursorAdapter(Activity activity, int itemViewLayoutId, TData[] datas,
//    //        Action<View, int, ViewGroup?>? renderItemView = null)
//    //        : base(activity, itemViewLayoutId, datas, renderItemView) { }

//    //    // tuple as params
//    //    public ItemViewCursorAdapter((Activity activity, int itemViewLayoutId, TData[] datas,
//    //        Action<View, int, ViewGroup?>? renderItemView) args) : this(args.activity, args.itemViewLayoutId, args.datas, args.renderItemView) { }

//    //    public ItemViewCursorAdapter((Activity activity, int itemViewLayoutId, TData[] datas) args)
//    //        : this(args.activity, args.itemViewLayoutId, args.datas, null) { }
//    //}





//    // note： addView(View, LayoutParams) is not supported in AdapterView

//    /// <summary>
//    /// The item views are isolated
//    /// </summary>
//    public class IsolatedItemViewAdapter<TData> : BaseItemViewAdapter<TData>
//    {
//        private readonly Action<View, int, ViewGroup?>? _reRenderItemView;

//        public IsolatedItemViewAdapter(Activity activity, int itemViewLayoutId, TData[] datas,
//            Action<View, int, ViewGroup?>? renderItemView = null, Action<View, int, ViewGroup?>? reRenderItemView = null)
//            : base(activity, itemViewLayoutId, datas, renderItemView) => _reRenderItemView = reRenderItemView;

//        // tuple as params
//        public IsolatedItemViewAdapter((Activity activity, int itemViewLayoutId, TData[] datas,
//            Action<View, int, ViewGroup?>? renderItemView, Action<View, int, ViewGroup?>? reRenderItemView) args)
//        : this(args.activity, args.itemViewLayoutId, args.datas, args.renderItemView, args.reRenderItemView) { }

//        public IsolatedItemViewAdapter((Activity activity, int itemViewLayoutId, TData[] datas,
//            Action<View, int, ViewGroup?>? renderItemView) args)
//        : this(args.activity, args.itemViewLayoutId, args.datas, args.renderItemView, null) { }

//        public IsolatedItemViewAdapter((Activity activity, int itemViewLayoutId, TData[] datas) args)
//        : this(args.activity, args.itemViewLayoutId, args.datas, null, null) { }


//        protected override void _InitializeWrappers(TData[] datas)
//        {

//            //replace with your item and your holder items
//            //comment back in
//            //view = inflater.Inflate(Resource.Layout.item, parent, false);
//            //holder.Title = view.FindViewById<TextView>(Resource.Id.text);
//            // var inflater = _activity.GetSystemService(Context.LayoutInflaterService).JavaCast<LayoutInflater>();
//            for (var i = 0; i < datas.Length; i++)
//            {
//                View? v = _activity.LayoutInflater.Inflate(_itemViewLayoutId, null)
//                    ?? throw new AndroidRuntimeException("At least one isolated view creation failed");
//                _wrappers.Add(new ViewInfoWrapper<TData>(i, datas[i], v, false));
//            }
//        }

//        public override long GetItemId(int position)
//        {
//            return position;
//        }

//        public override Java.Lang.Object GetItem(int position)
//        {
//            return _wrappers[position];
//        }
//        public override TData this[int position]
//        {
//            get { return _wrappers[position].Data; }
//        }
//        public override int Count
//        {
//            get { return _wrappers.Count; }
//        }

//        public override View GetView(int position, View? convertView, ViewGroup? parent)
//        {
//            // _wrappers[position].AssView is guaranteed not to be null
//            View v = _wrappers[position].AssView!;

//            if (!_wrappers[position].Ready)
//            {
//                if (_renderItemView != null)
//                    _renderItemView(v, position, null);
//                _wrappers[position].Ready = true;
//                //    Log.Debug("first GetView in isolated", $"when <{position}> creation,parent:{v.Parent == parent}");
//            }
//            else
//            {
//                //       Log.Debug("other GetView in isolated", $"when <{position}> creation, parent :{v.Parent == parent}");
//                _reRenderItemView?.Invoke(v, position, parent);
//            }
//            return v;
//        }
//    }

//    /// <summary>
//    /// The item views are shared
//    /// </summary>
//    /// <typeparam name="TData"></typeparam>
//    public class SharedItemViewAdapter<TData> : BaseItemViewAdapter<TData>
//    {
//        public SharedItemViewAdapter(Activity activity, int itemViewLayoutId, TData[] datas,
//            Action<View, int, ViewGroup?>? renderItemView = null)
//            : base(activity, itemViewLayoutId, datas, renderItemView) { }

//        // tuple as params
//        public SharedItemViewAdapter((Activity activity, int itemViewLayoutId, TData[] datas,
//            Action<View, int, ViewGroup?>? renderItemView) args) : this(args.activity, args.itemViewLayoutId, args.datas, args.renderItemView) { }

//        public SharedItemViewAdapter((Activity activity, int itemViewLayoutId, TData[] datas) args)
//            : this(args.activity, args.itemViewLayoutId, args.datas, null) { }

//        protected override void _InitializeWrappers(TData[] datas)
//        {
//            for (var i = 0; i < datas.Length; i++)
//                _wrappers.Add(new ViewInfoWrapper<TData>(i, datas[i], null, false));
//        }

//        public override long GetItemId(int position)
//        {
//            return position;
//        }

//        public override Java.Lang.Object GetItem(int position)
//        {
//            return _wrappers[position];
//        }
//        public override TData this[int position]
//        {
//            get { return _wrappers[position].Data; }
//        }
//        public override int Count
//        {
//            get { return _wrappers.Count; }
//        }

//        public override View GetView(int position, View? convertView, ViewGroup? parent)
//        {
//            View? view = convertView; // re-use an existing view, if one is available
//            if (view == null)// otherwise create a new one
//            {
//                view = _activity.LayoutInflater.Inflate(_itemViewLayoutId, parent, false);
//                if (view == null)
//                    throw new AndroidRuntimeException("At least one shared view creation failed");
//            }

//            Log.Debug("GetView in shared", $"when <{position}> creation, parent :{view.Parent}");
//            _wrappers[position].AssView = view;
//            _wrappers[position].Ready = true;
//            _renderItemView?.Invoke(view, position, parent);

//            return view;
//        }
//    }
//    public abstract class BaseItemViewAdapter<TData> : BaseAdapter<TData>
//    {
//        protected readonly List<ViewInfoWrapper<TData>> _wrappers;
//        protected readonly Activity _activity;
//        protected readonly int _itemViewLayoutId;
//        protected readonly Action<View, int, ViewGroup?>? _renderItemView;
//        //     protected readonly LayoutInflater _inflater;

//        protected BaseItemViewAdapter(Activity activity, int itemViewLayoutId, TData[] datas,
//            Action<View, int, ViewGroup?>? renderItemView = null)
//            : base()
//        {
//            (_activity, _itemViewLayoutId, _renderItemView) = (activity, itemViewLayoutId, renderItemView);
//            _wrappers = new List<ViewInfoWrapper<TData>>();
//            //      _inflater = _activity.GetSystemService(Activity.LayoutInflaterService);
//            _InitializeWrappers(datas);
//        }

//        // tuple as params
//        protected BaseItemViewAdapter((Activity activity, int itemViewLayoutId, TData[] datas,
//            Action<View, int, ViewGroup?>? renderItemView) args) : this(args.activity, args.itemViewLayoutId, args.datas, args.renderItemView) { }


//        protected abstract void _InitializeWrappers(TData[] datas);

//        public override long GetItemId(int position)
//        {
//            return position;
//        }

//        public override Java.Lang.Object GetItem(int position)
//        {
//            return _wrappers[position];
//        }
//        public override TData this[int position]
//        {
//            get { return _wrappers[position].Data; }
//        }
//        public override int Count
//        {
//            get { return _wrappers.Count; }
//        }
//    }
//    public class ViewInfoWrapper<TData> : Java.Lang.Object
//    {
//        public int Position { get; private set; }

//        public TData Data { get; private set; }

//        public View? AssView { get; set; }

//        public bool Ready { get; set; }

//        public ViewInfoWrapper(int position, TData data, View? assView = null, bool ready = false) =>
//        (Position, Data, AssView, Ready) = (position, data, assView, ready);
//    }
//}